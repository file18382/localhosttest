<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <style>
            body {
                position: absolute;
                height: 100%;
                width: 100%;
                margin: 0;
                padding: none;
                overflow: hidden;
            }
            p {
                position: absolute;
                top: 50%;
                left: 50%;
                translate: -50% -50%;
                font-size: 20px;
                color: white;
            }
            .startBtn {
                cursor: pointer;
                position: absolute;
                display: flex;
                top: 50%;
                left: 50%;
                translate: -50% -50%;
                padding: 10px;
                background: orange;
                border-radius: 50%;
                user-select: none;
                height: 60px;
                width: 60px;
                font-size: 14px;
                font-family: sans-serif;
                align-items: center;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <p
            class="startBtn"
            onclick="window.parent.addIsland('clock', window.parent.getIdApp(window.frameElement), 'clock', '', 'auto', () =>{window.parent.closeIsland(); setTimeout(() => {
                window.parent.removeIsland(window.parent.getIdApp(window.frameElement));h=0; m=0; s=0;
            },520);}, window.parent.getIframeByIdApp(window.parent.getIdApp(window.frameElement)).contentWindow.stopTimer); startTimer(); "
        >
            start timer
        </p>
    </body>

    <script>
        const id = window.parent.getIdApp(window.frameElement);

        let h = 0;
        let m = 0;
        let s = 0;

        let idTimer = null;
        function startTimer() {
            if (idTimer) return;
            idTimer = setInterval(() => {
                s++;
                if (s === 60) {
                    s = 0;
                    m++;
                }
                if (m === 60) {
                    m = 0;
                    h++;
                }

                const hh = String(h).padStart(2, "0");
                const mm = String(m).padStart(2, "0");
                const ss = String(s).padStart(2, "0");

                window.parent.updateIsland(id, "text", `${hh}:${mm}:${ss}`);
            }, 1000);
        }

        function stopTimer(e) {
            const el = e.currentTarget;

            console.log("asd");
            if (el.dataset.btn === "resume") {
                el.dataset.btn = "pause";
                startTimer();
            } else {
                el.dataset.btn = "resume";
                if (idTimer) clearInterval(idTimer);
                idTimer = null;
            }
        }
    </script>
</html>
